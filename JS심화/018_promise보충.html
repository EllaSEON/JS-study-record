<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promise</title>
</head>
<body>
    <script>
      //Promise 를 왜씀?
      //1. 비동기적인 작업을 처리할 때, 그 작업이 성공했는지 실패했는지 표준화된 방식을 이용해서 처리할수있게 해줌
      //2. 



      //fetch는 비동기적으로 처리함

      // console.log(1);
      // fetch('https://jsonplaceholder.typicode.com/posts')
      //   .then(function(response){
      //     return response.json();
      //   })
      //   .then(function(myJson){
      //     console.log(myJson);
      //   })
      // console.log(2);

      //어떤 함수를 사용하는데, 함수의 return 값이 Promise가 나오면 비동기적일 가능성이 높음

        // let fetched = fetch('https://jsonplaceholder.typicode.com/posts')
        // console.log('fetched',fetched)

        // fetched.then(function(result){
        //   console.log('result',result)
        // });
        // fetched.catch(function(reason){
        //   console.log('reason',reason)
        // });


        //fetch는 어차피 Promise 객체가 return되기 때문에, 위 예제처럼 변수로 뽑지 않고 fetch 함수로 호출되는게 어차피 return값이 Promise이기때문에 바로 점을 붙여서 then을 쓴다.

        //then 도 실행시키고 나면 또다시 Promise를 준다.
        //체이닝이 되어있기때문에 변수를 처리할 필요없이 catch로 전달한다.


        fetch('https://jsonplaceholder.typicode.com/posts')
        .then(function(response){
            // response.json().then(function(data){
            //   console.log('data',data)
            // }) //Nested promise 방식
            return response.json();
          })
          //response객체가 return되기 때문에 response로 바꿔주자
          //response에는 여러가지 정보가있다. 서버랑 통신에 성공했는지 여부, 서버와 어떤 통신을 했는지 결과를 코드값으로 보여줌
          // response가 갖고 있는 함수중에 json() 을 호출하면(json 텍스트가 json 데이터 타입이라는걸 자바스크립트에 알려준 것)
          //그래서 이 웹브라우저는 json 데이터 타입에 맞게 데이터를 해석해서 자바스크립트의 데이터타입으로 돌려주게됨
          //response.json()을 return 해보면 Promise가 나옴
          //이 Promise가 하는 역할은 json 텍스트를 자바스크립트의 데이터타입으로 컨버팅 하는 promise임.
          //그 promise는 컨버팅 작업이 끝났을 때 then을 호출할것임
          //자바스크립트의 데이터타입이 되므로 매우매우쉽게 작업할 수 있음
        .catch(function(reason){
          console.log('reason',reason)
        })
        .then(function(data){
          console.log('data',data)
        }) //promise 밖에서 then과 then을 연결시키는 걸 promise chainning

    </script>
</body>
</html>